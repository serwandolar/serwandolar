<!--
Filename: serwan-dollar-shop.html
Description: Single-file RTL Kurdish shopping page (HTML/CSS/JS) + example Node.js server (below) to forward registrations/orders to Telegram bot.
Notes:
 - For security, the Telegram bot token is used only on the server (server.js). Do NOT expose the token in client-side code.
 - The user provided token and admin id which are shown as placeholders in server.js; replace with actual values or set as environment variables.
 - To run server: `node server.js` (requires node >= 14 and package 'node-fetch' or use built-in fetch in modern Node). Install dependencies: `npm init -y && npm install express body-parser node-fetch`.
--><!doctype html>

<html lang="ku" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>سیروان دۆلار - شۆپینگ</title>
  <style>
    /* Simple Kurdish-friendly styling (RTL) */
    @font-face{
      font-family: 'KurdishUI';
      src: local('Noto Naskh Arabic'), local('Noto Sans Arabic');
    }
    :root{
      --bg:#f6fbff; --card:#ffffff; --accent:#0b63d6; --muted:#6b7280;
      font-family: 'KurdishUI', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:#0f172a;line-height:1.45}
    header{background:linear-gradient(90deg,var(--accent),#2b9bff);color:#fff;padding:28px 20px;text-align:center}
    header h1{margin:0;font-size:1.6rem}
    .container{max-width:900px;margin:22px auto;padding:16px}
    .card{background:var(--card);border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.08);padding:18px}
    label{display:block;margin-bottom:6px;font-weight:600}
    input[type=text],input[type=tel],select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef8;margin-bottom:12px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .price-list{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .price-item{flex:0 0 auto;padding:10px 14px;border-radius:10px;border:1px solid #e6eef8;cursor:pointer}
    .price-item.selected{background:#eef7ff;border-color:var(--accent);box-shadow:0 6px 18px rgba(11,99,214,0.08)}
    button{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer}
    footer{margin-top:14px;text-align:center;color:var(--muted);font-size:0.95rem}
    .small{font-size:0.9rem;color:var(--muted)}
    .result{padding:10px;border-radius:8px;margin-top:10px}
    .success{background:#ecfdf5;border:1px solid #bbf7d0;color:#065f46}
    .warn{background:#fff7ed;border:1px solid #ffedd5;color:#92400e}
  </style>
</head>
<body>
  <header>
    <h1>سیروان دۆلار - کڕینی دۆلار و دینار</h1>
    <div class="small">پەیوەندیکردن بە واتسئاپ/سناپ/تیکتۆک بۆ تۆمار</div>
  </header>  <main class="container">
    <div class="card">
      <h2>تۆمارکردن</h2>
      <p class="small">تکایە یەکێک پێشکەش بکە — ژمارەی واتسئاپ یان یوزەرنەیم سناپ/تیکتۆک</p>
      <form id="registerForm">
        <label>ناو</label>
        <input type="text" id="name" placeholder="ناوی تەواو" required />
        <label>ژمارەی واتسئاپ (یا)</label>
        <input type="tel" id="whatsapp" placeholder="+9647xxxxxxxx" />
        <label>یوزەرنەیم سناپ/تیکتۆک</label>
        <input type="text" id="social" placeholder="username (بیوانە بە بێ @)" />
        <div style="margin-top:8px"><button id="registerBtn" type="button">تۆمار کردن</button></div>
      </form>
      <div id="regResult" class="result" style="display:none"></div>
    </div><div style="height:14px"></div>

<div class="card">
  <h2>هەڵبژاردنی پاکەت / نرخ</h2>
  <div class="price-list" id="prices">
    <div class="price-item" data-id="25" data-price="500000">25 گەڵا — ٥٠٠,٠٠٠ دینار</div>
    <div class="price-item" data-id="50" data-price="900000">50 گەڵا — ٩٠٠,٠٠٠ دینار</div>
    <div class="price-item" data-id="3m" data-price="500000">3,000,000 دینار — ٥٠٠,٠٠٠ دینار</div>
  </div>

  <label>هەڵبژاردن</label>
  <select id="method">
    <option value="fiv">فێب (FIB)</option>
    <option value="card">کارتى مۆبایل</option>
  </select>

  <div style="margin-top:12px">
    <button id="orderBtn" type="button">داواکردن</button>
  </div>

  <div id="orderResult" class="result" style="display:none"></div>

</div>

<footer>
  <p class="small">نووسراوی: سیروان دۆلار — هەموو مافی وەسفەکان پارێزراون</p>
</footer>

  </main>  <script>
    // Client-side logic: selects, register, and order. Communicates with server endpoints.
    const pricesEl = document.getElementById('prices');
    let selected = null;
    pricesEl.addEventListener('click', e => {
      const item = e.target.closest('.price-item');
      if (!item) return;
      document.querySelectorAll('.price-item').forEach(i=>i.classList.remove('selected'));
      item.classList.add('selected');
      selected = {id: item.dataset.id, price: item.dataset.price, label: item.textContent.trim()};
    });

    // Register
    document.getElementById('registerBtn').addEventListener('click', async ()=>{
      const name = document.getElementById('name').value.trim();
      const whatsapp = document.getElementById('whatsapp').value.trim();
      const social = document.getElementById('social').value.trim();
      if(!name){showReg('تکایە ناو بنووسە','warn');return}
      const payload = {name, whatsapp, social};
      showReg('...', 'warn');
      try{
        const res = await fetch('/api/register', {method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(payload)});
        const j = await res.json();
        if(res.ok){showReg(j.message||'تۆمار بە سەرکەوتوویی', 'success')}else{showReg(j.error||'هەڵەیەک رویدا', 'warn')}
      }catch(err){showReg('هەڵە لە پەیوەندیدا — تکایە دواتر هەوڵبدەر','warn')}
    });

    function showReg(txt, cls){const el=document.getElementById('regResult');el.style.display='block';el.className='result '+(cls==='success'? 'success':'warn');el.textContent=txt}

    // Order
    document.getElementById('orderBtn').addEventListener('click', async ()=>{
      if(!selected){showOrder('تکایە پاکەتێک هەڵبژێرە','warn');return}
      const method = document.getElementById('method').value;
      const payload = {selection:selected, method};
      showOrder('...','warn');
      try{
        const res = await fetch('/api/order', {method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(payload)});
        const j = await res.json();
        if(res.ok){
          // show final screen message
          showOrder('سوپاس بۆ داوا کردن — تکایە بڕی پارەی پێویست بنێرە بۆ ئەدمین لە ڕێگای FIB یان کارت مۆبایل.','success');
        } else showOrder(j.error||'هەڵەیەک رویدا','warn')
      }catch(err){showOrder('هەڵە لە پەیوەندیدا — تکایە دواتر هەوڵبدەر','warn')}
    });

    function showOrder(txt, cls){const el=document.getElementById('orderResult');el.style.display='block';el.className='result '+(cls==='success'? 'success':'warn');el.textContent=txt}
  </script>  <!--
    Below: example Node.js server (server.js). Save as server.js and run with node.
    It receives /api/register and /api/order and forwards messages to Telegram using the bot token and admin id.
  -->  <!--
  ---- server.js (Example) ----
  const express = require('express');
  const bodyParser = require('body-parser');
  const fetch = require('node-fetch'); // or global fetch on modern node

  const app = express();
  app.use(bodyParser.json());

  // SECURITY: store sensitive values in environment variables, not in code.
  const TELEGRAM_TOKEN = process.env.TELEGRAM_TOKEN || '8276099023:AAFDpteLag3sID7u76kMqfM89Pw5GSHOKr0';
  const ADMIN_ID = process.env.ADMIN_ID || '8119964397';
  const TELEGRAM_API = `https://api.telegram.org/bot${TELEGRAM_TOKEN}`;

  function sendTelegram(text){
    return fetch(`${TELEGRAM_API}/sendMessage`,{
      method:'POST',
      headers:{'content-type':'application/json'},
      body:JSON.stringify({chat_id:ADMIN_ID, text, parse_mode:'HTML'})
    }).then(r=>r.json());
  }

  app.post('/api/register', async (req,res)=>{
    const {name, whatsapp, social} = req.body;
    if(!name) return res.status(400).json({error:'name required'});
    const msg = `<b>تۆمار نوێ</b>\nناو: ${name}\nواتسApp: ${whatsapp||'نیە'}\nسناپ/تیکتۆک: ${social||'نیە'}`;
    try{
      await sendTelegram(msg);
      return res.json({message:'تۆمار بە سەرکەوتوویی نێردرا'});
    }catch(e){console.error(e);return res.status(500).json({error:'نەتوانیت پەیام بنێریت'})}
  });

  app.post('/api/order', async (req,res)=>{
    const {selection, method} = req.body;
    if(!selection) return res.status(400).json({error:'selection required'});
    const msg = `<b>داواکاری نوێ</b>\nپاکەت: ${selection.label}\nنرخ (دینار): ${selection.price}\nڕێگە: ${method}`;
    try{
      await sendTelegram(msg);
      return res.json({message:'داواکاری نێردرا'});
    }catch(e){console.error(e);return res.status(500).json({error:'نەتوانیت پەیام بنێریت'})}
  });

  const port = process.env.PORT || 3000;
  app.listen(port, ()=>console.log('Server running on',port));
  ---- end server.js ----
  --></body>
</html>
